<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gerador de Email - LicenÃ§as Global Mapper</title>
  <link rel="icon" type="image/png" href="img/Treco_Engesat.png" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: url('img/padrao_pagina_email.png') no-repeat center center fixed;
      background-size: cover;
      background-color: #f5f5f5;
    }

    .container {
      background-color: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 8px;
      max-width: 900px;
      margin: auto;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }

    h1 {
      text-align: center;
    }

    .tabs {
      display: flex;
      margin-bottom: 20px;
      cursor: pointer;
      user-select: none;
    }

    .tab {
      flex: 1;
      padding: 12px;
      background: #ddd;
      text-align: center;
      border: 1px solid #bbb;
      border-bottom: none;
      transition: background 0.3s ease;
    }

    .tab.active {
      background: white;
      font-weight: bold;
      border-bottom: 1px solid white;
    }

    label {
      display: block;
      margin: 8px 0 4px;
      font-weight: bold;
    }

    input[type="text"], input[type="date"], select {
      width: 100%;
      padding: 6px;
      margin-bottom: 12px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 12px 20px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 12px;
      border-radius: 4px;
      transition: background 0.3s ease;
    }

    button:hover {
      background: #0056b3;
    }

    .email-output {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      font-size: 15px;
      line-height: 1.6;
      white-space: normal;
      max-height: 450px;
      overflow-y: auto;
      box-shadow: 0 0 8px rgba(0,0,0,0.12);
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Gerador de Email - LicenÃ§as Global Mapper</h1>

    <div class="tabs">
      <div class="tab active" data-lang="pt">PortuguÃªs</div>
      <div class="tab" data-lang="es">Espanhol</div>
      <div class="tab" data-lang="en">InglÃªs</div>
    </div>

    <form id="emailForm">
      <label for="ref_engesat">ğŸ“Œ ReferÃªncia - Interna:</label>
      <input type="text" id="ref_engesat" />

      <label for="ref_cliente">ğŸ“Œ ReferÃªncia - Cliente:</label>
      <input type="text" id="ref_cliente" />

      <label for="nome">ğŸ‘¤ Nome:</label>
      <input type="text" id="nome" />

      <label for="empresa">ğŸ¢ Empresa:</label>
      <input type="text" id="empresa" />

      <label for="endereco">ğŸ“ EndereÃ§o:</label>
      <input type="text" id="endereco" />

      <label for="cidade">ğŸŒ† Cidade:</label>
      <input type="text" id="cidade" />

      <label for="pais">ğŸŒ PaÃ­s:</label>
      <input type="text" id="pais" />

      <label for="email">ğŸ“§ Email:</label>
      <input type="text" id="email" />

      <label for="telefone">ğŸ“ Telefone:</label>
      <input type="text" id="telefone" />

      <label for="num_licencas">ğŸ“¦ NÃºmero de LicenÃ§as:</label>
      <select id="num_licencas">
        <option value="">Selecione</option>
        <option>1</option><option>2</option><option>3</option><option>4</option>
        <option>5</option><option>6</option><option>7</option><option>8</option>
        <option>9</option><option>10</option>
      </select>

      <label for="tipo_licenca">ğŸ’» Tipo de LicenÃ§a:</label>
      <select id="tipo_licenca">
        <option value="">Selecione</option>
        <option>Global Mapper Standalone</option>
        <option>Global Mapper Flutuante</option>
        <option>Global Mapper em Rede</option>
        <option>Global Mapper em USB</option>
        <option>Global Mapper Pro Standalone</option>
        <option>Global Mapper Pro Flutuante</option>
        <option>Global Mapper Pro em Rede</option>
        <option>Global Mapper Pro USB</option>
        <option>Global Mapper + Global Mapper Pro Standalone</option>
        <option>Global Mapper + Global Mapper Pro Flutuante</option>
        <option>Global Mapper + Global Mapper Pro em Rede</option>
        <option>Global Mapper + Global Mapper Pro USB</option>
        <option>RenovaÃ§Ã£o Global Mapper Standalone</option>
        <option>RenovaÃ§Ã£o Global Mapper Flutuante</option>
        <option>RenovaÃ§Ã£o Global Mapper em Rede</option>
        <option>RenovaÃ§Ã£o Global Mapper USB</option>
        <option>RenovaÃ§Ã£o Global Mapper Pro Standalone</option>
        <option>RenovaÃ§Ã£o Global Mapper Pro Flutuante</option>
        <option>RenovaÃ§Ã£o Global Mapper Pro em Rede</option>
        <option>RenovaÃ§Ã£o Global Mapper Pro USB</option>
        <option>RenovaÃ§Ã£o Global Mapper + Global Mapper Pro Standalone</option>
        <option>RenovaÃ§Ã£o Global Mapper + Global Mapper Pro Flutuante</option>
        <option>RenovaÃ§Ã£o Global Mapper + Global Mapper Pro em Rede</option>
        <option>RenovaÃ§Ã£o Global Mapper + Global Mapper Pro USB</option>
      </select>

      <label for="data_inicial_suporte">ğŸ“… Data Inicial de Suporte:</label>
      <input type="date" id="data_inicial_suporte" />

      <label for="data_final_suporte">ğŸ“… Data Final de Suporte:</label>
      <input type="date" id="data_final_suporte" />

      <label for="idioma_email">ğŸŒ Idioma:</label>
      <select id="idioma_email">
        <option>PortuguÃªs</option>
        <option>Espanhol</option>
        <option>InglÃªs</option>
      </select>

      <label for="order_number">ğŸ”¢ Blue Marble Order:</label>
      <input type="text" id="order_number" />

      <button type="button" id="gerarBtn">Gerar Email</button>
    </form>

    <div id="emailOutput" class="email-output" style="display:none;"></div>
    <button type="button" id="copyBtn" style="display:none;">Copiar Email</button>
  </div>

  <script>
    const tabs = document.querySelectorAll('.tab');
    const idiomaSelect = document.getElementById('idioma_email');
    const gerarBtn = document.getElementById('gerarBtn');
    const output = document.getElementById('emailOutput');
    const copyBtn = document.getElementById('copyBtn');

    const textos = {
      pt: {
        saudacao: "Prezados,",
        licencas: "LicenÃ§as PerpÃ©tuas",
        download: "Segue o link para download do instalador do software em sua versÃ£o mais recente:",
        setup: "O arquivo de setup do aplicativo em portuguÃªs, versÃ£o 26.1, pode ser baixado no link abaixo:",
        link1: "https://www.bluemarblegeo.com/products/global-mapper-daily-builds.php",
        instrucoes: "InstruÃ§Ãµes detalhadas estÃ£o disponÃ­veis em:",
        link2: "http://www.engesat.com.br/softwares/global-mapper/instalacao-e-ativacao/",
        senha: "Caso nÃ£o possua senha definida, utilize a opÃ§Ã£o â€œGerenciar Contaâ€ para recuperÃ¡-la via e-mail e assim voltar a acessar o site.",
        recomendacao: "Recomendamos realizar um backup do arquivo de instalaÃ§Ã£o e guardar estas instruÃ§Ãµes em local seguro.",
        ativacao: "ApÃ³s a instalaÃ§Ã£o do software, faÃ§a login com seu e-mail e senha no site da Blue Marble e insira o Order Id no campo \"Order Number\".",
        duvidas: "Caso tenha dÃºvidas ou dificuldades, consulte as instruÃ§Ãµes ou entre em contato conosco.",
        contato_whatsapp: "Contato: +55 (41) 99134-0990 (tambÃ©m Whatsapp) <a href=\"https://api.whatsapp.com/send?phone=554191340990\" target=\"_blank\">WhatsApp</a>",
        contato_email: "Email: <a href=\"mailto:laurent.engesat@gmail.com\">laurent.engesat@gmail.com</a>",
        link_registro_senha: `<br/><a href="https://www.bluemarblegeo.com/users/register.php" target="_blank">https://www.bluemarblegeo.com/users/register.php</a>`,
        suporte_inicial: "Data Inicial de Suporte",
        suporte_final: "Data Final de Suporte",
        // >>> URLs das imagens - SUBSTITUA PELOS SEUS LINKS REAIS HOSPEDADOS ONLINE <<<
        imagem_quadro_ativacao: "img/Quadrinho PortuguÃªs - AtivaÃ§Ã£o de Licenca GM - Post.png", // Ex: "https://i.imgur.com/QuadrinhoPT.png"
        alt_quadro_ativacao: "Quadro de AtivaÃ§Ã£o de LicenÃ§a Global Mapper - PortuguÃªs"
      },
      es: {
        saudacao: "Estimados,",
        licencas: "Licencias Perpetuas",
        download: "Adjunto el enlace para descargar el instalador del software en su versiÃ³n mÃ¡s reciente:",
        setup: "El archivo de instalaciÃ³n del aplicativo en espaÃ±ol, versiÃ³n 26.1, puede descargarse en el enlace a continuaciÃ³n:",
        link1: "https://www.bluemarblegeo.com/products/global-mapper-daily-builds.php",
        instrucoes: "Instrucciones detalladas disponibles en:",
        link2: "http://www.engesat.com.br/softwares/global-mapper/instalacion-y-activacion/",
        senha: "Si no tiene una contraseÃ±a definida, utilice la opciÃ³n â€œAdministrar Cuentaâ€ para recuperarla vÃ­a correo electrÃ³nico y asÃ­ poder acceder nuevamente al sitio.",
        recomendacao: "Recomendamos realizar una copia de seguridad del archivo de instalaciÃ³n y guardar estas instrucciones en un lugar seguro.",
        ativacao: "DespuÃ©s de instalar el software, inicie sesiÃ³n con su correo electrÃ³nico y contraseÃ±a en el sitio de Blue Marble e ingrese el Order Id en el campo \"Order Number\".",
        duvidas: "Si tiene dudas o dificultades, consulte las instrucciones o contÃ¡ctenos.",
        contato_whatsapp: "Contacto: +55 (41) 99134-0990 (tambiÃ©n Whatsapp) <a href=\"https://api.whatsapp.com/send?phone=554191340990\" target=\"_blank\">WhatsApp</a>",
        contato_email: "Correo electrÃ³nico: <a href=\"mailto:laurent.engesat@gmail.com\">laurent.engesat@gmail.com</a>",
        link_registro_senha: `<br/><a href="https://www.bluemarblegeo.com/users/register.php" target="_blank">https://www.bluemarblegeo.com/users/register.php</a>`,
        suporte_inicial: "Fecha Inicial de Soporte",
        suporte_final: "Fecha Final de Soporte",
        // >>> URLs das imagens - SUBSTITUA PELOS SEUS LINKS REAIS HOSPEDADOS ONLINE <<<
        imagem_quadro_ativacao: "img/Quadrinho Espanhol - AtivaÃ§Ã£o de Licenca GM - Post.png", // Ex: "https://i.imgur.com/QuadrinhoES.png"
        alt_quadro_ativacao: "Cuadro de ActivaciÃ³n de Licencia Global Mapper - EspaÃ±ol"
      },
      en: {
        saudacao: "Dear all,",
        licencas: "Perpetual Licenses",
        download: "Please find the link to download the software installer in its latest version:",
        setup: "The setup file of the application in English, version 26.1, can be downloaded at the link below:",
        link1: "https://www.bluemarblegeo.com/products/global-mapper-daily-builds.php",
        instrucoes: "Detailed instructions are available at:",
        link2: "http://www.engesat.com.br/softwares/global-mapper/installation-and-activation/",
        senha: "If you do not have a defined password, use the â€œManage Accountâ€ option to recover it via email and regain access to the site.",
        recomendacao: "We recommend making a backup of the installation file and keeping these instructions in a safe place.",
        ativacao: "After installing the software, log in with your email and password on the Blue Marble site and enter the Order Id in the \"Order Number\" field.",
        duvidas: "If you have any questions or difficulties, consult the instructions or contact us.",
        contato_whatsapp: "Contact: +55 (41) 99134-0990 (also Whatsapp) <a href=\"https://api.whatsapp.com/send?phone=554191340990\" target=\"_blank\">WhatsApp</a>",
        contato_email: "Email: <a href=\"mailto:laurent.engesat@gmail.com\">laurent.engesat@gmail.com</a>",
        link_registro_senha: `<br/><a href="https://www.bluemarblegeo.com/users/register.php" target=\"_blank\">https://www.bluemarblegeo.com/users/register.php</a>`,
        suporte_inicial: "Initial Support Date",
        suporte_final: "Final Support Date",
        // >>> URLs das imagens - SUBSTITUA PELOS SEUS LINKS REAIS HOSPEDADOS ONLINE <<<
        // Se a imagem em inglÃªs for a mesma que a espanhola, use o mesmo URL.
        imagem_quadro_ativacao: "img/Quadrinho Espanhol - AtivaÃ§Ã£o de Licenca GM - Post.png", // Ex: "https://i.imgur.com/QuadrinhoEN.png"
        alt_quadro_ativacao: "Global Mapper License Activation Box - English"
      }
    };

    // >>> URL da imagem do logo da empresa - SUBSTITUA PELO SEU LINK REAL HOSPEDADO ONLINE <<<
    const imageUrlLogo = "img/Logo Engesat.png"; // Ex: "https://i.imgur.com/LogoEngesat.png"
    const imageAltTextLogo = "Logo Engesat";

    let langKey = 'pt';

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        langKey = tab.getAttribute('data-lang');

        if(langKey === 'pt') idiomaSelect.value = 'PortuguÃªs';
        else if(langKey === 'es') idiomaSelect.value = 'Espanhol';
        else if(langKey === 'en') idiomaSelect.value = 'InglÃªs';
      });
    });

    function get(id) {
      return document.getElementById(id).value.trim();
    }

    gerarBtn.addEventListener('click', () => {
      const t = textos[langKey];
      const refCliente = get('ref_cliente');
      const dataInicialSuporte = get('data_inicial_suporte');
      const dataFinalSuporte = get('data_final_suporte');

      const camposObrigatorios = [
        { id: 'ref_engesat', nome: 'ReferÃªncia - Interna' },
        { id: 'ref_cliente', nome: 'ReferÃªncia - Cliente' },
        { id: 'nome', nome: 'Nome' },
        { id: 'empresa', nome: 'Empresa' },
        { id: 'endereco', nome: 'EndereÃ§o' },
        { id: 'cidade', nome: 'Cidade' },
        { id: 'pais', nome: 'PaÃ­s' },
        { id: 'email', nome: 'Email' },
        { id: 'telefone', nome: 'Telefone' },
        { id: 'num_licencas', nome: 'NÃºmero de LicenÃ§as' },
        { id: 'tipo_licenca', nome: 'Tipo de LicenÃ§a' },
        { id: 'data_inicial_suporte', nome: 'Data Inicial de Suporte' },
        { id: 'data_final_suporte', nome: 'Data Final de Suporte' },
        { id: 'order_number', nome: 'Blue Marble Order' }
      ];

      const camposVazios = camposObrigatorios.filter(campo => !get(campo.id));

      if (camposVazios.length > 0) {
        alert('Os seguintes campos nÃ£o foram preenchidos:\n\n' + camposVazios.map(c => `- ${c.nome}`).join('\n') + '\n\nO email serÃ¡ gerado mesmo assim.');
      }

      const texto = `
<p><strong>ğŸ“Œ ReferÃªncia - Interna:</strong> <span style="font-weight:bold; color:#007bff;">${get('ref_engesat')}</span><br/>
<strong>ğŸ“Œ ReferÃªncia - Cliente:</strong> <span style="font-weight:bold; color:#007bff;">${refCliente}</span></p>

<p><strong>ğŸ‘¤ Nome:</strong> ${get('nome')}<br/>
<strong>ğŸ¢ Empresa:</strong> ${get('empresa')}<br/>
<strong>ğŸ“ EndereÃ§o:</strong> ${get('endereco')}<br/>
<strong>ğŸŒ† Cidade:</strong> ${get('cidade')}<br/>
<strong>ğŸŒ PaÃ­s:</strong> ${get('pais')}<br/>
<strong>ğŸ“§ Email:</strong> ${get('email')}<br/>
<strong>ğŸ“ Telefone:</strong> ${get('telefone')}</p>

<p>${t.saudacao}</p>

<p>${langKey === 'pt' ? 'Segue o e-mail formal de entrega referente a' : langKey === 'es' ? 'Adjunto el correo formal de entrega referente a' : 'Please find the formal delivery email referring to'} <strong>ğŸ“¦ ${get('num_licencas')} ${t.licencas} ${get('tipo_licenca')}</strong>, ${langKey === 'pt' ? 'em' : langKey === 'es' ? 'en' : 'in'} <strong>ğŸŒ ${get('idioma_email')}</strong>.<br/>
<strong>Blue Marble Order:</strong> <strong style="color:#007bff;">#${get('order_number')}</strong>.</p>

<p><strong>${t.suporte_inicial}:</strong> ${dataInicialSuporte}<br/>
<strong>${t.suporte_final}:</strong> ${dataFinalSuporte}</p>

<h3>ğŸ› ï¸ ${langKey === 'pt' ? 'Download do Software' : langKey === 'es' ? 'Descarga del Software' : 'Software Download'}:</h3>
<p>${t.download}<br/>
${t.setup}<br/>
<a href="${t.link1}" target="_blank">${t.link1}</a></p>

<h3>ğŸ“– ${langKey === 'pt' ? 'InstruÃ§Ãµes detalhadas' : langKey === 'es' ? 'Instrucciones detalladas' : 'Detailed Instructions'}:</h3>
<ul>
  <li>${t.instrucoes}</li>
  <li><a href="${t.link2}" target="_blank">${t.link2}</a></li>
</ul>

<h3>ğŸ”‘ ${langKey === 'pt' ? 'Senha' : langKey === 'es' ? 'ContraseÃ±a' : 'Password'}:</h3>
<ul>
  <li>${t.senha} 
  ${t.link_registro_senha || ''}
  </li>
</ul>

<h3>âš ï¸ ${langKey === 'pt' ? 'RecomendaÃ§Ãµes' : langKey === 'es' ? 'Recomendaciones' : 'Recommendations'}:</h3>
<ul>
  <li>${t.recomendacao}</li>
</ul>

<h3>âœ… ${langKey === 'pt' ? 'AtivaÃ§Ã£o das LicenÃ§as' : langKey === 'es' ? 'ActivaciÃ³n de Licencias' : 'License Activation'}:</h3>
<ul>
  <li>${t.ativacao}</li>
</ul>

<p style="text-align: center; margin-top: 10px; margin-bottom: 20px;">
  <img src="${t.imagem_quadro_ativacao}" alt="${t.alt_quadro_ativacao}" style="max-width: 600px; height: auto; display: block; margin: 0 auto; border: 0;">
</p>

<h3>â“ ${langKey === 'pt' ? 'DÃºvidas' : langKey === 'es' ? 'Dudas' : 'Questions'}:</h3>
<ul>
  <li>${t.duvidas}</li>
  <li>${t.contato_whatsapp}</li>
  <li>${t.contato_email}</li>
</ul>

<p>Atenciosamente,<br/>Laurent Martin</p>

<p style="text-align: center; margin-top: 20px;">
  <img src="${imageUrlLogo}" alt="${imageAltTextLogo}" style="max-width: 150px; height: auto; display: block; margin: 0 auto; border: 0;">
</p>

      `.trim();

      output.style.display = 'block';
      output.innerHTML = texto;
      copyBtn.style.display = 'inline-block';
    });

    copyBtn.addEventListener('click', () => {
      if (navigator.clipboard && window.ClipboardItem) {
        const blobInput = new Blob([output.innerHTML], { type: 'text/html' });
        const data = [new ClipboardItem({ 'text/html': blobInput })];
        navigator.clipboard.write(data).then(() => {
          alert('Email copiado com formataÃ§Ã£o para a Ã¡rea de transferÃªncia!');
        }).catch(() => {
          fallbackCopyText();
        });
      } else {
        fallbackCopyText();
      }

      function fallbackCopyText() {
        const el = document.createElement('textarea');
        el.value = output.innerText;
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
        alert('Email copiado como texto (sem formataÃ§Ã£o).');
      }
    });

  </script>
</body>
</html>
