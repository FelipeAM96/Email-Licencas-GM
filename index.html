<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gerador de Email - Licen√ßas Global Mapper</title>
  <link rel="icon" type="image/png" href="img/Treco_Engesat.png" />
  <style>
    /* Estilos Gerais */
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif;
      margin: 0;
      padding: 40px 20px;
      background-color: #f0f4f8; /* Fundo suave e claro */
      color: #334e68; /* Cor de texto principal */
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    /* Container Principal */
    .container {
      background-color: #ffffff;
      padding: 35px;
      border-radius: 12px;
      width: 100%;
      max-width: 800px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08); /* Sombra mais suave */
      transition: transform 0.3s ease-in-out;
    }

    /* T√≠tulo e logo */
    .header-logo {
      text-align: center;
      margin-bottom: 25px;
    }

    .header-logo img {
      max-width: 250px; /* Ajuste o tamanho da logo conforme necess√°rio */
      height: auto;
      margin-bottom: 15px; /* Espa√ßo entre a logo e o t√≠tulo */
    }

    h1 {
      text-align: center;
      color: #2b3b51;
      font-size: 2.2em;
      font-weight: 600;
      margin: 0;
    }

    /* Abas de Idioma */
    .tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 30px;
      border-radius: 8px;
      background-color: #e9ecef; /* Fundo das abas */
      padding: 5px;
      cursor: pointer;
      user-select: none;
    }

    .tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      font-weight: 500;
      color: #5a7184;
      border-radius: 6px;
      transition: background-color 0.3s, color 0.3s;
    }

    .tab.active {
      background-color: #ffffff;
      color: #007bff;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    /* Formul√°rio e campos */
    label {
      display: block;
      margin-top: 15px;
      margin-bottom: 6px;
      font-weight: 600;
      color: #334e68;
      font-size: 0.95em;
    }

    input[type="text"], input[type="date"], select {
      width: 100%;
      padding: 12px;
      box-sizing: border-box;
      border: 1px solid #ced4da;
      border-radius: 8px;
      font-size: 1em;
      color: #495057;
      background-color: #f8f9fa;
      transition: border-color 0.3s, box-shadow 0.3s;
    }

    input[type="text"]:focus, input[type="date"]:focus, select:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
    }

    /* Bot√µes */
    button {
      width: 100%;
      padding: 15px;
      margin-top: 25px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.1em;
      font-weight: 600;
      letter-spacing: 0.5px;
      transition: background 0.3s ease, transform 0.1s ease;
    }

    button:hover {
      background: #0056b3;
      transform: translateY(-2px);
    }

    button#copyBtn {
      background: #28a745; /* Cor para o bot√£o de copiar */
    }

    button#copyBtn:hover {
      background: #218838;
    }

    /* √Årea de Sa√≠da do Email */
    .email-output {
      background: #fdfdfd;
      padding: 30px;
      border-radius: 12px;
      margin-top: 30px;
      font-size: 1em;
      line-height: 1.7;
      white-space: normal;
      max-height: 500px;
      overflow-y: auto;
      border: 1px solid #e9ecef;
      word-wrap: break-word; /* Quebra de linha para palavras longas */
    }

    .email-output p, .email-output ul, .email-output h3, .email-output h4 {
        margin-top: 1em;
        margin-bottom: 1em;
    }

    /* ================================================= */
    /* Media Queries para Responsividade */
    /* ================================================= */

    @media (max-width: 768px) {
      body {
        padding: 20px 10px; /* Reduz o padding em telas menores */
      }

      .container {
        padding: 20px; /* Reduz o padding do container */
        border-radius: 8px; /* Arredondamento menor */
      }

      .header-logo img {
        max-width: 180px; /* Reduz o tamanho da logo */
      }

      h1 {
        font-size: 1.8em; /* Reduz o tamanho da fonte do t√≠tulo */
      }

      .tabs {
        flex-direction: column; /* Alinha as abas verticalmente */
        padding: 0;
        background-color: transparent; /* Remove o fundo das abas */
      }

      .tab {
        border-bottom: 2px solid #e9ecef;
        border-radius: 0;
      }

      .tab:last-child {
        border-bottom: none;
      }

      .tab.active {
        box-shadow: none; /* Remove a sombra da aba ativa */
        background-color: #f8f9fa; /* Fundo mais claro para aba ativa */
      }

      button {
        padding: 12px; /* Reduz o padding dos bot√µes */
        font-size: 1em; /* Reduz o tamanho da fonte do bot√£o */
      }

      .email-output {
        padding: 15px; /* Reduz o padding da √°rea de sa√≠da */
        font-size: 0.9em; /* Reduz o tamanho da fonte do email gerado */
      }

      /* Esta √© a nova regra para todas as imagens dentro do container */
      .container img {
        max-width: 100% !important;
        height: auto;
      }

      /* E para a imagem do quadro de ativa√ß√£o dentro do email gerado */
      .email-output img {
        width: 100% !important; /* For√ßa a largura para 100% do seu cont√™iner */
      }
    }

  </style>
</head>
<body>
  <div class="container">
    <div class="header-logo">
      <img src="img/GlobalMapper.png" alt="Logo Global Mapper" />
      <h1>Gerador de Email de Licen√ßas</h1>
    </div>

    <div class="tabs">
      <div class="tab active" data-lang="pt">Portugu√™s</div>
      <div class="tab" data-lang="es">Espa√±ol</div>
      <div class="tab" data-lang="en">English</div>
    </div>

    <form id="emailForm">
      <label for="ref_engesat">üìå Refer√™ncia Interna:</label>
      <input type="text" id="ref_engesat" placeholder="Ex: Pedido 25010" />

      <label for="ref_cliente">üìù Refer√™ncia do Cliente:</label>
      <input type="text" id="ref_cliente" placeholder="Ex: Ordem de Compra #OC-XYZ" />

      <label for="nome">üë§ Nome:</label>
      <input type="text" id="nome" placeholder="Nome do cliente" />

      <label for="empresa">üè¢ Empresa:</label>
      <input type="text" id="empresa" placeholder="Nome da empresa" />

      <label for="endereco">üìç Endere√ßo:</label>
      <input type="text" id="endereco" placeholder="Endere√ßo completo" />

      <label for="cidade">üåÜ Cidade:</label>
      <input type="text" id="cidade" placeholder="Nome da cidade" />

      <label for="pais">üåé Pa√≠s:</label>
      <input type="text" id="pais" placeholder="Nome do pa√≠s" />

      <label for="email">üìß Email:</label>
      <input type="text" id="email" placeholder="email@exemplo.com" />

      <label for="telefone">üìû Telefone:</label>
      <input type="text" id="telefone" placeholder="(XX) XXXX-XXXX" />

      <label for="num_licencas">üì¶ N√∫mero de Licen√ßas:</label>
      <select id="num_licencas">
        <option value="">Selecione</option>
        <option>1</option><option>2</option><option>3</option><option>4</option>
        <option>5</option><option>6</option><option>7</option><option>8</option>
        <option>9</option><option>10</option>
      </select>

      <label for="tipo_licenca">üíª Tipo de Licen√ßa:</label>
      <select id="tipo_licenca">
        <option value="">Selecione</option>
        <option>Global Mapper Standalone</option>
        <option>Global Mapper Flutuante</option>
        <option>Global Mapper em Rede</option>
        <option>Global Mapper em USB</option>
        <option>Global Mapper Pro Standalone</option>
        <option>Global Mapper Pro Flutuante</option>
        <option>Global Mapper Pro em Rede</option>
        <option>Global Mapper Pro USB</option>
        <option>Global Mapper + Global Mapper Pro Standalone</option>
        <option>Global Mapper + Global Mapper Pro Flutuante</option>
        <option>Global Mapper + Global Mapper Pro em Rede</option>
        <option>Global Mapper + Global Mapper Pro USB</option>
        <option>Renova√ß√£o Global Mapper Standalone</option>
        <option>Renova√ß√£o Global Mapper Flutuante</option>
        <option>Renova√ß√£o Global Mapper em Rede</option>
        <option>Renova√ß√£o Global Mapper USB</option>
        <option>Renova√ß√£o Global Mapper Pro Standalone</option>
        <option>Renova√ß√£o Global Mapper Pro Flutuante</option>
        <option>Renova√ß√£o Global Mapper Pro em Rede</option>
        <option>Renova√ß√£o Global Mapper Pro USB</option>
        <option>Renova√ß√£o Global Mapper + Global Mapper Pro Standalone</option>
        <option>Renova√ß√£o Global Mapper + Global Mapper Pro Flutuante</option>
        <option>Renova√ß√£o Global Mapper + Global Mapper Pro em Rede</option>
        <option>Renova√ß√£o Global Mapper + Global Mapper Pro USB</option>
      </select>

      <label for="data_inicial_suporte">üìÖ Data Inicial de Suporte:</label>
      <input type="date" id="data_inicial_suporte" />

      <label for="data_final_suporte">üìÖ Data Final de Suporte:</label>
      <input type="date" id="data_final_suporte" />

      <label for="idioma_email">üåê Idioma da Licen√ßa:</label>
      <select id="idioma_email">
        <option>Portugu√™s</option>
        <option>Espa√±ol</option>
        <option>English</option>
      </select>

      <label for="order_number">üî¢ Blue Marble Order:</label>
      <input type="text" id="order_number" placeholder="Ex: 123450-K5ONMNMG" />

      <button type="button" id="gerarBtn">Gerar Email</button>
    </form>

    <div id="emailOutput" class="email-output" style="display:none;"></div>
    <button type="button" id="copyBtn" style="display:none;">Copiar Email</button>
  </div>

  <script>
    const tabs = document.querySelectorAll('.tab');
    const idiomaSelect = document.getElementById('idioma_email');
    const gerarBtn = document.getElementById('gerarBtn');
    const output = document.getElementById('emailOutput');
    const copyBtn = document.getElementById('copyBtn');

    const textos = {
      pt: {
        saudacao: "Prezados,",
        introducao_licencas: "Segue o e-mail formal de entrega referente a",
        licencas: "Licen√ßas Perp√©tuas",
        download: "Segue o link para download do instalador do software em sua vers√£o mais recente:",
        setup: "O arquivo de setup do aplicativo em portugu√™s, vers√£o 26.1, pode ser baixado no link abaixo:",
        link1: "https://www.bluemarblegeo.com/products/global-mapper-daily-builds.php",
        instrucoes: "Instru√ß√µes detalhadas est√£o dispon√≠veis em:",
        link2: "http://www.engesat.com.br/softwares/global-mapper/instalacao-e-ativacao/",
        senha: "Caso n√£o possua senha definida, utilize a op√ß√£o ‚ÄúGerenciar Conta‚Äù para recuper√°-la via e-mail e assim voltar a acessar o site.",
        recomendacao: "Recomendamos realizar um backup do arquivo de instala√ß√£o e guardar estas instru√ß√µes em local seguro.",
        ativacao: "Ap√≥s a instala√ß√£o do software, fa√ßa login com seu e-mail e senha no site da Blue Marble e insira o Order Id no campo \"Order Number\".",
        duvidas: "Caso tenha d√∫vidas ou dificuldades, consulte as instru√ß√µes ou entre em contato conosco.",
        contato_whatsapp: "Contato: +55 (41) 99134-0990 (tamb√©m Whatsapp) <a href=\"https://api.whatsapp.com/send?phone=554191340990\" target=\"_blank\">WhatsApp</a>",
        contato_email: "Email: <a href=\"mailto:laurent.engesat@gmail.com\">laurent.engesat@gmail.com</a>",
        link_registro_senha: `<br/><a href="https://www.bluemarblegeo.com/users/register.php" target=\"_blank\">https://www.bluemarblegeo.com/users/register.php</a>`,
        suporte_inicial: "Data Inicial de Suporte",
        suporte_final: "Data Final de Suporte",
        suporte_renovacao_info: "A renova√ß√£o do suporte e das atualiza√ß√µes do software √© anual. Refor√ßamos a import√¢ncia dessa renova√ß√£o para garantir assist√™ncia t√©cnica, recupera√ß√£o do software em caso de falhas nos equipamentos e orienta√ß√µes sobre seu uso. Apenas clientes com suporte ativo ter√£o acesso a atualiza√ß√µes, novos recursos e suporte t√©cnico.",
        imagem_quadro_ativacao: "img/Quadrinho Portugu√™s - Ativa√ß√£o de Licenca GM - Post.png", // Ex: "https://i.imgur.com/QuadrinhoPT.png"
        alt_quadro_ativacao: "Quadro de Ativa√ß√£o de Licen√ßa Global Mapper - Portugu√™s",
        assinatura: "Atenciosamente,<br/>Laurent Martin",
        licenseExplanations: {
          "Standalone": `
            <h3>- Standalone</h3>
            <p>A licen√ßa Standalone funciona como um passe de acesso para um software que fica preso a um √∫nico computador. Voc√™ n√£o consegue us√°-la remotamente de outro aparelho. √â ideal para quem tem um computador principal e trabalha individualmente, ou para uma pessoa dentro de uma equipe que usa uma √∫nica m√°quina dedicada.</p>
            <p>Voc√™ pode mover essa licen√ßa at√© duas vezes por ano para outro computador, mas a remo√ß√£o do aparelho anterior precisa ser verificada. Se voc√™ precisa mudar o software de computador com frequ√™ncia, essa licen√ßa n√£o √© a mais indicada, pois as poucas movimenta√ß√µes anuais podem se tornar um impedimento para o seu trabalho.</p>
          `,
          "Flutuante": `
            <h3>- Flutuante</h3>
            <p>A licen√ßa Flutuante de Usu√°rio √önico √© bem mais flex√≠vel que a Standalone. Pense nela como um "passe de acesso" que, embora esteja instalado em um computador espec√≠fico, pode ser acessado de outras m√°quinas. Isso significa que voc√™ pode usar o software remotamente, por exemplo, atrav√©s de uma conex√£o de √Årea de Trabalho Remota (RDP), acessando o computador onde a licen√ßa est√° instalada.</p>
            <p>A grande vantagem √© a liberdade de movimenta√ß√£o: voc√™ pode transferir essa licen√ßa entre computadores um n√∫mero ilimitado de vezes. Para fazer isso, basta liberar a licen√ßa do computador anterior antes de ativ√°-la em uma nova m√°quina. Isso √© ideal se voc√™ alterna o uso entre um laptop e um desktop, ou se precisa acessar o software de diferentes locais. No entanto, √© importante notar que ela n√£o √© feita para ser compartilhada por v√°rias pessoas ou para escrit√≥rios com m√∫ltiplos usu√°rios simult√¢neos, pois continua sendo uma licen√ßa para uso individual.</p>
          `,
          "Rede": `
            <h3>- Em Rede</h3>
            <p>A Licen√ßa de Rede √© a escolha ideal para equipes e grupos de usu√°rios, oferecendo uma forma pr√°tica de gerenciar o acesso ao software. Em vez de ser atrelada a um √∫nico computador ou a um dispositivo f√≠sico, essa licen√ßa √© hospedada em um servidor. Isso significa que ela pode ser acessada por diversos usu√°rios dentro de uma rede, seja ela em um √∫nico escrit√≥rio ou em v√°rias filiais.</p>
            <p>O funcionamento √© simples: o n√∫mero de usu√°rios que podem usar o software ao mesmo tempo √© limitado pela quantidade de licen√ßas adquiridas. Se voc√™ tem uma licen√ßa para dois usu√°rios, por exemplo, at√© duas pessoas podem acessar e utilizar o programa simultaneamente na rede. Al√©m disso, essa licen√ßa oferece a flexibilidade de emprestar uma licen√ßa do servidor por at√© 90 dias se um usu√°rio precisar trabalhar fora da rede, como em viagens. √â a solu√ß√£o perfeita para garantir que sua equipe tenha acesso ao software de forma eficiente e controlada.</p>
          `,
          "USB": `
            <h3>- USB</h3>
            <p>A licen√ßa por dongle USB √© a solu√ß√£o perfeita para quem precisa de total flexibilidade para usar o software em diferentes computadores. Pense no dongle como uma "chave f√≠sica" que cont√©m a sua licen√ßa. Para usar o Global Mapper, voc√™ s√≥ precisa ter o programa instalado na m√°quina e conectar o dongle USB.</p>
            <p>A maior vantagem √© a mobilidade ilimitada: basta plugar o dongle onde voc√™ quiser usar o software. N√£o h√° necessidade de procedimentos complicados de remo√ß√£o ou ativa√ß√£o a cada troca de m√°quina, eliminando o inc√¥modo de liberar a licen√ßa antes de passar para um novo computador. Isso torna essa licen√ßa ideal para profissionais que trabalham em v√°rios locais, alternam entre desktop e laptop constantemente, ou que precisam da liberdade de usar o software em qualquer m√°quina dispon√≠vel, desde que o dongle esteja conectado.</p>
          `
        }
      },
      es: {
        saudacao: "Estimados,",
        introducao_licencas: "Se adjunta el correo electr√≥nico de entrega formal referente a",
        licencas: "Licencias Perpetuas",
        download: "Adjunto el enlace para descargar el instalador del software en su versi√≥n m√°s reciente:",
        setup: "El archivo de instalaci√≥n del aplicativo en espa√±ol, versi√≥n 26.1, puede descargarse en el enlace a continuaci√≥n:",
        link1: "https://www.bluemarblegeo.com/products/global-mapper-daily-builds.php",
        instrucoes: "Instrucciones detalladas disponibles en:",
        link2: "http://www.engesat.com.br/softwares/global-mapper/instalacion-y-activacion/",
        senha: "Si no tiene una contrase√±a definida, utilice la opci√≥n ‚ÄúAdministrar Cuenta‚Äù para recuperarla v√≠a correo electr√≥nico y as√≠ poder acceder nuevamente al sitio.",
        recomendacao: "Recomendamos realizar una copia de seguridad del archivo de instalaci√≥n y guardar estas instrucciones en un lugar seguro.",
        ativacao: "Despu√©s de instalar el software, inicie sesi√≥n con su correo electr√≥nico y contrase√±a en el sitio de Blue Marble e ingrese el Order Id en el campo \"Order Number\".",
        duvidas: "Si tiene dudas o dificultades, consulte las instrucciones o cont√°ctenos.",
        contato_whatsapp: "Contacto: +55 (41) 99134-0990 (tambi√©n Whatsapp) <a href=\"https://api.whatsapp.com/send?phone=554191340990\" target=\"_blank\">WhatsApp</a>",
        contato_email: "Correo electr√≥nico: <a href=\"mailto:laurent.engesat@gmail.com\">laurent.engesat@gmail.com</a>",
        link_registro_senha: `<br/><a href="https://www.bluemarblegeo.com/users/register.php" target=\"_blank\">https://www.bluemarblegeo.com/users/register.php</a>`,
        suporte_inicial: "Fecha Inicial de Soporte",
        suporte_final: "Fecha Final de Soporte",
        suporte_renovacao_info: "La renovaci√≥n del soporte y las actualizaciones del software es anual. Recalcamos la importancia de esta renovaci√≥n para garantizar asistencia t√©cnica, recuperaci√≥n del software en caso de fallos en los equipos y orientaci√≥n sobre su uso. Solo los clientes con soporte activo tendr√°n acceso a actualizaciones, nuevas funciones y soporte t√©cnico.",
        imagem_quadro_ativacao: "img/Quadrinho Espanhol - Ativa√ß√£o de Licenca GM - Post.png", // Ex: "https://i.imgur.com/QuadrinhoES.png"
        alt_quadro_ativacao: "Cuadro de Activaci√≥n de Licencia Global Mapper - Espa√±ol",
        assinatura: "Saludos cordiales,<br/>Laurent Martin",
        licenseExplanations: {
          "Standalone": `
            <h3>- Standalone</h3>
            <p>La licencia Standalone funciona como un pase de acceso para un software que est√° anclado a un solo computador. No puedes usarla remotamente desde otro dispositivo. Es ideal para quienes tienen un computador principal y trabajan individualmente, o para una persona dentro de un equipo que usa una √∫nica m√°quina dedicada.</p>
            <p>Puedes mover esta licencia hasta dos veces al a√±o a otro computador, pero la eliminaci√≥n del dispositivo anterior debe ser verificada. Si necesitas cambiar el software de computador con frecuencia, esta licencia no es la m√°s indicada, ya que los pocos movimientos anuales pueden convertirse en un impedimento para tu trabajo.</p>
          `,
          "Flutuante": `
            <h3>- Flotante</h3>
            <p>La licencia Flotante de Usuario √önico es mucho m√°s flexible que la Standalone. Piensa en ella como un "pase de acceso" que, aunque est√© instalado en un computador espec√≠fico, puede ser accedido desde otras m√°quinas. Esto significa que puedes usar el software remotamente, por ejemplo, a trav√©s de una conexi√≥n de Escritorio Remoto (RDP), accediendo al computador donde la licencia est√° instalada.</p>
            <p>La gran ventaja es la libertad de movimiento: puedes transferir esta licencia entre computadores un n√∫mero ilimitado de veces. Para hacer esto, simplemente libera la licencia del computador anterior antes de activarla en una nueva m√°quina. Esto es ideal si alternas el uso entre una laptop y un escritorio, o si necesitas acceder al software desde diferentes ubicaciones. Sin embargo, es importante tener en cuenta que no est√° dise√±ada para ser compartida por varias personas o para oficinas con m√∫ltiples usuarios simult√°neos, ya que sigue siendo una licencia de uso individual.</p>
          `,
          "Rede": `
            <h3>- En Red</h3>
            <p>La Licencia de Red es la opci√≥n ideal para equipos y grupos de usuarios, ofreciendo una forma pr√°ctica de gestionar el acceso al software. En lugar de estar vinculada a un √∫nico computador o a un dispositivo f√≠sico, esta licencia se aloja en un servidor. Esto significa que puede ser accedida por diversos usuarios dentro de una red, ya sea en una √∫nica oficina o en varias sucursales.</p>
            <p>El funcionamiento es sencillo: el n√∫mero de usuarios que pueden usar el software al mismo tiempo est√° limitado por la cantidad de licencias adquiridas. Si tienes una licencia para dos usuarios, por ejemplo, hasta dos personas pueden acceder y utilizar el programa simult√°neamente en la red. Adem√°s, esta licencia ofrece la flexibilidad de prestar una licencia del servidor por hasta 90 d√≠as si un usuario necesita trabajar fuera de la red, como en viajes. Es la soluci√≥n perfecta para garantizar que tu equipo tenga acceso al software de forma eficiente y controlada.</p>
          `,
          "USB": `
            <h3>- USB</h3>
            <p>La licencia por dongle USB es la soluci√≥n perfecta para quienes necesitan total flexibilidad para usar el software en diferentes computadores. Piensa en el dongle como una "llave f√≠sica" que contiene tu licencia. Para usar Global Mapper, solo necesitas tener el programa instalado en la m√°quina y conectar el dongle USB.</p>
            <p>La mayor ventaja es la movilidad ilimitada: simplemente conecta el dongle donde quieras usar el software. No hay necesidad de procedimientos complicados de remoci√≥n o activaci√≥n en cada cambio de m√°quina, eliminando la molestia de liberar la licencia antes de pasar a un nuevo computador. Esto hace que esta licencia sea ideal para profesionales que trabajan en varios lugares, alternan entre escritorio y laptop constantemente, o que necesitan la libertad de usar el software en cualquier m√°quina disponible, siempre que el dongle est√© conectado.</p>
          `
        }
      },
      en: {
        saudacao: "Dear all,",
        introducao_licencas: "Attached is the formal delivery email regarding",
        licencas: "Perpetual Licenses",
        download: "Please find the link to download the software installer in its latest version:",
        setup: "The setup file of the application in English, version 26.1, can be downloaded at the link below:",
        link1: "https://www.bluemarblegeo.com/products/global-mapper-daily-builds.php",
        instrucoes: "Detailed instructions are available at:",
        link2: "http://www.engesat.com.br/softwares/global-mapper/instalacion-y-activacion/",
        senha: "If you do not have a defined password, use the ‚ÄúManage Account‚Äù option to recover it via email and regain access to the site.",
        recomendacao: "We recommend making a backup of the installation file and keeping these instructions in a safe place.",
        ativacao: "After installing the software, log in with your email and password on the Blue Marble site and enter the Order Id in the \"Order Number\" field.",
        duvidas: "If you have any questions or difficulties, consult the instructions or contact us.",
        contato_whatsapp: "Contact: +55 (41) 99134-0990 (also Whatsapp) <a href=\"https://api.whatsapp.com/send?phone=554191340990\" target=\"_blank\">WhatsApp</a>",
        contato_email: "Email: <a href=\"mailto:laurent.engesat@gmail.com\">laurent.engesat@gmail.com</a>",
        link_registro_senha: `<br/><a href="https://www.bluemarblegeo.com/users/register.php" target=\"_blank\">https://www.bluemarblegeo.com/users/register.php</a>`,
        suporte_inicial: "Initial Support Date",
        suporte_final: "Final Support Date",
        suporte_renovacao_info: "The renewal of software support and updates is annual. We emphasize the importance of this renewal to ensure technical assistance, software recovery in case of equipment failures, and guidance on its use. Only clients with active support will have access to updates, new features, and technical support.",
        imagem_quadro_ativacao: "img/Quadrinho Espanhol - Ativa√ß√£o de Licenca GM - Post.png", // Ensure you have an English version or use the Spanish one as a placeholder if not
        alt_quadro_ativacao: "Global Mapper License Activation Box - English",
        assinatura: "Best regards,<br/>Laurent Martin",
        licenseExplanations: {
          "Standalone": `
            <h3>- Standalone</h3>
            <p>A Standalone license functions as an access pass for software that is tied to a single computer. You can't use it remotely from another device. It's ideal for those who have a primary computer and work individually, or for one person within a team who uses a single dedicated machine.</p>
            <p>You can move this license up to two times per year to another computer, but the removal from the previous device needs to be verified. If you frequently need to move the software between computers, this license is not the most suitable, as the few annual movements can become an impediment to your work.</p>
          `,
          "Flutuante": `
            <h3>- Floating</h3>
            <p>The Single-User Floating license is much more flexible than the Standalone. Think of it as an "access pass" that, although installed on a specific computer, can be accessed from other machines. This means you can use the software remotely, for example, through a Remote Desktop Protocol (RDP) connection, by accessing the computer where the license is installed.</p>
            <p>The big advantage is the freedom of movement: you can transfer this license between computers an unlimited number of times. To do this, simply release the license from the previous computer before activating it on a new machine. This is ideal if you alternate use between a laptop and a desktop, or if you need to access the software from different locations. However, it's important to note that it's not designed to be shared by multiple people or for offices with multiple simultaneous users, as it remains a license for individual use.</p>
          `,
          "Rede": `
            <h3>- Network</h3>
            <p>The Network License is the ideal choice for teams and user groups, offering a practical way to manage software access. Instead of being tied to a single computer or a physical device, this license is hosted on a server. This means it can be accessed by various users within a network, whether in a single office or across multiple branches.</p>
            <p>The operation is simple: the number of users who can use the software simultaneously is limited by the number of licenses purchased. If you have a license for two users, for example, up to two people can access and use the program simultaneously on the network. Additionally, this license offers the flexibility to borrow a license from the server for up to 90 days if a user needs to work off the network, such as when traveling. It's the perfect solution to ensure your team has efficient and controlled access to the software.</p>
          `,
          "USB": `
            <h3>- USB</h3>
            <p>The USB dongle license is the perfect solution for those who need complete flexibility to use the software on different computers. Think of the dongle as a "physical key" that contains your license. To use Global Mapper, you just need to have the program installed on the machine and connect the USB dongle.</p>
            <p>The biggest advantage is unlimited mobility: just plug the dongle wherever you want to use the software. There's no need for complicated removal or activation procedures with each machine change, eliminating the hassle of releasing the license before moving to a new computer. This makes this license ideal for professionals who work in various locations, constantly switch between desktop and laptop, or who need the freedom to use the software on any available machine, as long as the dongle is connected.</p>
          `
        }
      }
    };

    // >>> URL da imagem do logo da empresa - SUBSTITUA PELO SEU LINK REAL HOSPEDADO ONLINE <<<
    const imageUrlLogo = "img/Logo Engesat.png"; // Ex: "https://i.imgur.com/LogoEngesat.png"
    const imageAltTextLogo = "Logo Engesat";

    let langKey = 'pt';

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        langKey = tab.getAttribute('data-lang');

        if(langKey === 'pt') idiomaSelect.value = 'Portugu√™s';
        else if(langKey === 'es') idiomaSelect.value = 'Espa√±ol';
        else if(langKey === 'en') idiomaSelect.value = 'English';
      });
    });

    function get(id) {
      return document.getElementById(id).value.trim();
    }

    // Fun√ß√£o para formatar a data de YYYY-MM-DD para DD/MM/YYYY
    function formatarData(data) {
        if (!data) return '';
        const [ano, mes, dia] = data.split('-');
        return `${dia}/${mes}/${ano}`;
    }

    gerarBtn.addEventListener('click', () => {
      const t = textos[langKey];
      const refCliente = get('ref_cliente');
      const tipoLicencaSelecionada = get('tipo_licenca'); // Get the full selected license type
      const dataInicialSuporte = formatarData(get('data_inicial_suporte'));
      const dataFinalSuporte = formatarData(get('data_final_suporte'));

      const camposObrigatorios = [
        { id: 'ref_engesat', nome: 'Refer√™ncia - Interna' },
        { id: 'ref_cliente', nome: 'Refer√™ncia - Cliente' },
        { id: 'nome', nome: 'Nome' },
        { id: 'empresa', nome: 'Empresa' },
        { id: 'endereco', nome: 'Endere√ßo' },
        { id: 'cidade', nome: 'Cidade' },
        { id: 'pais', nome: 'Pa√≠s' },
        { id: 'email', nome: 'Email' },
        { id: 'telefone', nome: 'Telefone' },
        { id: 'num_licencas', nome: 'N√∫mero de Licen√ßas' },
        { id: 'tipo_licenca', nome: 'Tipo de Licen√ßa' },
        { id: 'data_inicial_suporte', nome: 'Data Inicial de Suporte' },
        { id: 'data_final_suporte', nome: 'Data Final de Suporte' },
        { id: 'order_number', nome: 'Blue Marble Order' }
      ];

      const camposVazios = camposObrigatorios.filter(campo => !get(campo.id));

      if (camposVazios.length > 0) {
        alert('Os seguintes campos n√£o foram preenchidos:\n\n' + camposVazios.map(c => `- ${c.nome}`).join('\n') + '\n\nO email ser√° gerado mesmo assim.');
      }

      // Determine the base license type for explanation lookup
      let explicacaoLicenca = '';
      if (tipoLicencaSelecionada.includes("Standalone")) {
        explicacaoLicenca = t.licenseExplanations["Standalone"] || '';
      } else if (tipoLicencaSelecionada.includes("Flutuante")) {
        explicacaoLicenca = t.licenseExplanations["Flutuante"] || '';
      } else if (tipoLicencaSelecionada.includes("Rede")) {
        explicacaoLicenca = t.licenseExplanations["Rede"] || '';
      } else if (tipoLicencaSelecionada.includes("USB")) {
        explicacaoLicenca = t.licenseExplanations["USB"] || '';
      }


      const texto = `
<p style="text-align: center; margin-top: 0; margin-bottom: 20px;">
  <img src="img/GlobalMapper.png" alt="Logo Global Mapper" width="250" height="auto" style="max-width: 250px; height: auto; display: block; margin: 0 auto; border: 0;">
</p>

<p><strong>üìå Refer√™ncia Interna:</strong> <span style="font-weight:bold; color:#007bff;">${get('ref_engesat')}</span><br/>
<strong>üìù Refer√™ncia do Cliente:</strong> <span style="font-weight:bold; color:#007bff;">${refCliente}</span></p>

<p><strong>üë§ Nome:</strong> ${get('nome')}<br/>
<strong>üè¢ Empresa:</strong> ${get('empresa')}<br/>
<strong>üìç Endere√ßo:</strong> ${get('endereco')}<br/>
<strong>üåÜ Cidade:</strong> ${get('cidade')}<br/>
<strong>üåé Pa√≠s:</strong> ${get('pais')}<br/>
<strong>üìß Email:</strong> ${get('email')}<br/>
<strong>üìû Telefone:</strong> ${get('telefone')}</p>

<p>${t.saudacao}</p>

<p>${t.introducao_licencas} <strong>üì¶ ${get('num_licencas')} ${t.licencas} ${tipoLicencaSelecionada}</strong>, <strong>üåê ${get('idioma_email')}</strong>.<br/>
<strong>Blue Marble Order:</strong> <strong style="color:#007bff;">#${get('order_number')}</strong>.</p>

${explicacaoLicenca} <p><strong>${t.suporte_inicial}:</strong> ${dataInicialSuporte}<br/>
<strong>${t.suporte_final}:</strong> ${dataFinalSuporte}
${t.suporte_renovacao_info ? `<br/><span style="color: red; font-size: 0.9em;">${t.suporte_renovacao_info}</span>` : ''}
</p>

<h3>üõ†Ô∏è ${langKey === 'pt' ? 'Download do Software' : langKey === 'es' ? 'Descarga del Software' : 'Software Download'}:</h3>
<p>${t.download}<br/>
${t.setup}<br/>
<a href="${t.link1}" target="_blank">${t.link1}</a></p>

<h3>üìñ ${langKey === 'pt' ? 'Instru√ß√µes detalhadas' : langKey === 'es' ? 'Instrucciones detalladas' : 'Detailed Instructions'}:</h3>
<ul>
  <li>${t.instrucoes}</li>
  <li><a href="${t.link2}" target="_blank">${t.link2}</a></li>
</ul>

<h3>üîë ${langKey === 'pt' ? 'Senha' : langKey === 'es' ? 'Contrase√±a' : 'Password'}:</h3>
<ul>
  <li>${t.senha}
  ${t.link_registro_senha || ''}
  </li>
</ul>

<h3>‚ö†Ô∏è ${langKey === 'pt' ? 'Recomenda√ß√µes' : langKey === 'es' ? 'Recomendaciones' : 'Recommendations'}:</h3>
<ul>
  <li>${t.recomendacao}</li>
</ul>

<h3>‚úÖ ${langKey === 'pt' ? 'Ativa√ß√£o das Licen√ßas' : langKey === 'es' ? 'Activaci√≥n de Licencias' : 'License Activation'}:</h3>
<ul>
  <li>${t.ativacao}</li>
</ul>

<p style="text-align: center; margin-top: 10px; margin-bottom: 20px;">
  <img src="${t.imagem_quadro_ativacao}" alt="${t.alt_quadro_ativacao}" width="600" height="auto" style="max-width: 600px; height: auto; display: block; margin: 0 auto; border: 0;">
</p>

<h3>‚ùì ${langKey === 'pt' ? 'D√∫vidas' : langKey === 'es' ? 'Dudas' : 'Questions'}:</h3>
<ul>
  <li>${t.duvidas}</li>
  <li>${t.contato_whatsapp}</li>
  <li>${t.contato_email}</li>
</ul>

<p>${t.assinatura}</p>

<p style="text-align: center; margin-top: 20px;">
  <img src="${imageUrlLogo}" alt="${imageAltTextLogo}" width="150" height="auto" style="max-width: 150px; height: auto; display: block; margin: 0 auto; border: 0;">
</p>
      `.trim();

      output.style.display = 'block';
      output.innerHTML = texto;
      copyBtn.style.display = 'inline-block';
    });

    copyBtn.addEventListener('click', () => {
      if (navigator.clipboard && window.ClipboardItem) {
        const blobInput = new Blob([output.innerHTML], { type: 'text/html' });
        const data = [new ClipboardItem({ 'text/html': blobInput })];
        navigator.clipboard.write(data).then(() => {
          alert('Email copiado com formata√ß√£o para a √°rea de transfer√™ncia!');
        }).catch(() => {
          fallbackCopyText();
        });
      } else {
        fallbackCopyText();
      }

      function fallbackCopyText() {
        const el = document.createElement('textarea');
        el.value = output.innerText;
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
        alert('Email copiado como texto (sem formata√ß√£o).');
      }
    });

  </script>
</body>
</html>